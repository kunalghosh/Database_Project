CREATE TABLE STUDENT_DETAILS(
USN CHAR(10),
NAME VARCHAR(30),
SEMESTER NUMBER(1),
ELIGIBLE NUMBER(1) CHECK (ELIGIBLE=0 OR ELIGIBLE=1),
CONSTRAINT PK_USN PRIMARY KEY(USN)
);
CREATE TABLE PRAC_SUBJECT(
SUBJECT_CODE CHAR(7),
SUBJECT_NAME VARCHAR(30),
SUBJECT_OF_SEMESTER NUMBER(1),
CONSTRAINT PK_SC PRIMARY KEY(SUBJECT_CODE)
);
CREATE TABLE LABS(
LABNO NUMBER (1),
SUBJECT_CODE CHAR(7),
CONSTRAINT FK_LSC FOREIGN KEY(SUBJECT_CODE) REFERENCES PRAC_SUBJECT(SUBJECT_CODE) ON DELETE CASCADE
);
CREATE TABLE REGULAR_PRACS(
SUBJECT_CODE CHAR(7),
SEMESTER NUMBER(1),
CONSTRAINT FK_RPSC FOREIGN KEY(SUBJECT_CODE) REFERENCES PRAC_SUBJECT(SUBJECT_CODE) ON DELETE CASCADE
);
CREATE TABLE STUDS_WITH_ARREARS(
USN CHAR(10),
SUBJECT_CODE CHAR(7),
CONSTRAINT FK_SWASC FOREIGN KEY(SUBJECT_CODE) REFERENCES PRAC_SUBJECT(SUBJECT_CODE) ON DELETE CASCADE,
CONSTRAINT FK_SWAU FOREIGN KEY(USN) REFERENCES STUDENT_DETAILS(USN) ON DELETE CASCADE
);
CREATE TABLE EXAM_DATES(
SUBJECT_CODE CHAR(7),
EDATE DATE,
CONSTRAINT FK_EDSC FOREIGN KEY(SUBJECT_CODE) REFERENCES PRAC_SUBJECT(SUBJECT_CODE) ON DELETE CASCADE
);

CREATE TABLE CLASH_DETECT(
USN CHAR(10),
EDATE DATE,
CONSTRAINT FK_CDUSN FOREIGN KEY(USN) REFERENCES STUDENT_DETAILS(USN) ON DELETE CASCADE,
CONSTRAINT FK_CDED FOREIGN KEY(EDATE) REFERENCES EXAM_DATES(EDATE) ON DELETE CASCADE
);

INSERT INTO REGULAR_PRACS VALUES ('06CSL37',03);
INSERT INTO REGULAR_PRACS VALUES ('06CSL38',03);
INSERT INTO REGULAR_PRACS VALUES ('06CSL47',04);
INSERT INTO REGULAR_PRACS VALUES ('06CSL48',04);
INSERT INTO REGULAR_PRACS VALUES ('06CSL57',05);
INSERT INTO REGULAR_PRACS VALUES ('06CSL58',05);
INSERT INTO REGULAR_PRACS VALUES ('06CSL67',06);
INSERT INTO REGULAR_PRACS VALUES ('06CSL68',06);
INSERT INTO REGULAR_PRACS VALUES ('06CSL77',07);
INSERT INTO REGULAR_PRACS VALUES ('06CSL78',07);
INSERT INTO REGULAR_PRACS VALUES ('06CSL87',08);
INSERT INTO REGULAR_PRACS VALUES ('06CSL88',08);

CREATE TRIGGER studs_with_arrears_trig
BEFORE DELETE ON STUDENT_DETAILS
FOR EACH ROW BEGIN
    DELETE FROM STUDS_WITH_ARREARS WHERE USN = OLD.USN;
END;

CREATE TRIGGER sub_code_trig1
BEFORE DELETE ON PRAC_SUBJECT
FOR EACH ROW BEGIN
	DELETE FROM REGULAR_PRACS WHERE REGULAR_PRACS.SUBJECT_CODE=OLD.SUBJECT_CODE;	
END;


CREATE TRIGGER sub_code_trig2
BEFORE DELETE ON PRAC_SUBJECT
FOR EACH ROW BEGIN
	DELETE FROM STUDS_WITH_ARREARS STUDS_WITH_ARREARS.SUBJECT_CODE=OLD.SUBJECT_CODE;
END;

CREATE TRIGGER sub_code_trig3
BEFORE DELETE ON PRAC_SUBJECT
FOR EACH ROW BEGIN
	DELETE FROM LABS LABS.SUBJECT_CODE=OLD.SUBJECT_CODE;
END;

CREATE TRIGGER sub_code_trig4
BEFORE DELETE ON PRAC_SUBJECT
FOR EACH ROW BEGIN
	DELETE FROM EXAM_DATES EXAM_DATES.SUBJECT_CODE=OLD.SUBJECT_CODE;
END;













   
